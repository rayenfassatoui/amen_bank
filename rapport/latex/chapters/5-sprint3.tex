\chapter{Sprint 3 - Module Validation et Assignment}

\section{Introduction}

Le Sprint 3 se concentre sur l'impl√©mentation du workflow multiniveaux qui transforme une demande soumise en demande pr√™te √† √™tre dispatch√©e. Ce sprint est crucial car il met en place les m√©canismes d'approbation et d'allocation des ressources logistiques, deux √©tapes essentielles dans le processus de gestion des fonds.

\section{Vue d'Ensemble}

Le module de validation et d'assignment couvre deux processus distincts mais s√©quentiels :

\begin{enumerate}[leftmargin=*]
    \item \textbf{Validation par la Caisse Centrale} : Examen des demandes soumises et d√©cision d'approbation ou de rejet
    \item \textbf{Assignment par Tunisie S√©curit√©} : Attribution d'une √©quipe de transport (chauffeur + garde) aux demandes valid√©es
\end{enumerate}

Ces processus garantissent que seules les demandes l√©gitimes sont trait√©es et que les ressources humaines et logistiques sont correctement allou√©es.

\section{Objectif Principal}

L'objectif principal du Sprint 3 est d'automatiser le processus d'approbation et d'attribution des ressources logistiques, tout en assurant une tra√ßabilit√© compl√®te de chaque d√©cision et action. Le syst√®me doit permettre aux diff√©rents acteurs de prendre des d√©cisions √©clair√©es rapidement.

\section{User Stories D√©taill√©es}

Le tableau \ref{tab:user-stories-sprint3} pr√©sente les user stories du Sprint 3.

\begin{table}[H]
\centering
\caption{User Stories - Sprint 3}
\label{tab:user-stories-sprint3}
\small
\begin{tabular}{@{}p{1cm}p{2.5cm}p{5cm}p{4cm}p{1.5cm}@{}}
\toprule
\textbf{ID} & \textbf{En tant que} & \textbf{Je veux} & \textbf{Crit√®res d'acceptation} & \textbf{Priorit√©} \\ 
\midrule
US-06 & Caisse Centrale & Valider une demande soumise & Transition SUBMITTED ‚Üí VALIDATED & Must \\
\midrule
US-07 & Caisse Centrale & Rejeter une demande avec motif & Ajouter justification obligatoire & Must \\
\midrule
US-08 & Tunisie S√©curit√© & Assigner une √©quipe √† une demande & S√©lectionner chauffeur + garde & Must \\
\midrule
US-09 & Tunisie S√©curit√© & Voir liste √©quipes disponibles & CIN + noms + disponibilit√© & Must \\
\midrule
US-10 & Syst√®me & Tracer chaque action & Logs utilisateur + timestamp & Should \\
\midrule
US-11 & Syst√®me & Envoyer notifications & Notifier changements statut & Could \\
\bottomrule
\end{tabular}
\end{table}

\section{Analyse et Sp√©cifications}

\subsection{Diagramme de Cas d'Utilisation - Sprint 3}

La figure \ref{fig:use-case-sprint3} pr√©sente les cas d'utilisation du Sprint 3.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{use-case-sprint3.png}
    \caption{Diagramme de cas d'utilisation - Sprint 3}
    \label{fig:use-case-sprint3}
\end{figure}

Les cas d'utilisation principaux sont :
\begin{itemize}[leftmargin=*]
    \item \textbf{Valider demande} : Approbation par la Caisse Centrale
    \item \textbf{Rejeter demande} : Refus avec justification
    \item \textbf{Assigner √©quipe} : Allocation des ressources logistiques
    \item \textbf{Consulter √©quipes disponibles} : Vue sur les ressources
    \item \textbf{Enregistrer action} : Tra√ßabilit√© automatique
\end{itemize}

\subsection{Raffinements Textuels - Sc√©nario Validation}

\subsubsection{Cas d'utilisation : Valider une Demande}

\textbf{Acteur Principal :} Utilisateur Caisse Centrale

\textbf{Pr√©conditions :}
\begin{itemize}[leftmargin=*]
    \item L'utilisateur est authentifi√© avec le r√¥le Caisse Centrale
    \item Une demande existe avec statut SUBMITTED
    \item Les fonds n√©cessaires sont disponibles
\end{itemize}

\textbf{Sc√©nario nominal :}
\begin{enumerate}[leftmargin=*]
    \item L'utilisateur acc√®de √† la liste des demandes en attente (statut = SUBMITTED)
    \item L'utilisateur clique sur une demande pour voir les d√©tails
    \item Le syst√®me affiche toutes les informations (montant, agence, denominations)
    \item L'utilisateur examine la demande (v√©rification de la pertinence)
    \item L'utilisateur clique sur le bouton "Valider"
    \item Le syst√®me affiche un dialog de confirmation
    \item L'utilisateur confirme la validation
    \item Le syst√®me met √† jour le statut de la demande ‚Üí VALIDATED
    \item Le syst√®me enregistre la date et l'utilisateur ayant valid√©
    \item Le syst√®me cr√©e un log d'action (action: VALIDATED, actor: userId)
    \item Le syst√®me envoie une notification √† Tunisie S√©curit√©
    \item Le syst√®me affiche un message de succ√®s
    \item La vue est rafra√Æchie, la demande n'appara√Æt plus dans la liste SUBMITTED
\end{enumerate}

\textbf{Postconditions :}
\begin{itemize}[leftmargin=*]
    \item La demande passe au statut VALIDATED
    \item Tunisie S√©curit√© peut maintenant assigner une √©quipe
    \item Un log d'action est cr√©√© pour audit
\end{itemize}

\subsubsection{Sc√©nario Alternatif : Rejet avec Motif}

\textbf{Point de divergence :} √âtape 5 du sc√©nario nominal

\begin{enumerate}[leftmargin=*]
    \item L'utilisateur identifie un probl√®me (montant excessif, demande non justifi√©e)
    \item L'utilisateur clique sur le bouton "Rejeter"
    \item Le syst√®me affiche un dialog avec un champ texte "Motif du rejet"
    \item L'utilisateur saisit une justification d√©taill√©e (minimum 10 caract√®res)
    \item L'utilisateur confirme le rejet
    \item Le syst√®me valide la pr√©sence du motif
    \item Le syst√®me met √† jour le statut ‚Üí REJECTED
    \item Le syst√®me enregistre le motif, la date et l'utilisateur
    \item Le syst√®me cr√©e un log d'action (action: REJECTED, details: motif)
    \item Le syst√®me envoie une notification √† l'agence √©mettrice
    \item Le syst√®me affiche un message de succ√®s
    \item La vue est rafra√Æchie
\end{enumerate}

\subsection{Raffinements Textuels - Sc√©nario Assignment}

\subsubsection{Cas d'utilisation : Assigner une √âquipe}

\textbf{Acteur Principal :} Utilisateur Tunisie S√©curit√©

\textbf{Pr√©conditions :}
\begin{itemize}[leftmargin=*]
    \item L'utilisateur est authentifi√© avec le r√¥le Tunisie S√©curit√©
    \item Une demande existe avec statut VALIDATED
    \item Des agents de s√©curit√© sont disponibles
\end{itemize}

\textbf{Sc√©nario nominal :}
\begin{enumerate}[leftmargin=*]
    \item L'utilisateur acc√®de √† la liste des demandes valid√©es (statut = VALIDATED)
    \item L'utilisateur s√©lectionne une demande √† traiter
    \item L'utilisateur clique sur "Assigner une √©quipe"
    \item Le syst√®me affiche un dialog modal avec un formulaire
    \item Le formulaire contient :
    \begin{itemize}
        \item Dropdown "Chauffeur" avec liste des chauffeurs disponibles
        \item Dropdown "Garde" avec liste des gardes disponibles
        \item Champ "Notes" optionnel
    \end{itemize}
    \item L'utilisateur s√©lectionne un chauffeur dans la liste
    \item L'utilisateur s√©lectionne un garde dans la liste (diff√©rent du chauffeur)
    \item L'utilisateur ajoute des notes si n√©cessaire
    \item L'utilisateur clique sur "Assigner"
    \item Le syst√®me valide que chauffeur ‚â† garde
    \item Le syst√®me v√©rifie la disponibilit√© des deux agents
    \item Le syst√®me met √† jour le statut ‚Üí ASSIGNED
    \item Le syst√®me enregistre les IDs des agents, la date et l'utilisateur
    \item Le syst√®me cr√©e un log d'action avec d√©tails de l'√©quipe
    \item Le syst√®me envoie des notifications (Agence + Caisse Centrale)
    \item Le syst√®me affiche un message de succ√®s
    \item La vue est rafra√Æchie
\end{enumerate}

\textbf{Postconditions :}
\begin{itemize}[leftmargin=*]
    \item La demande passe au statut ASSIGNED
    \item Une √©quipe est assign√©e (chauffeur + garde identifi√©s)
    \item La demande est pr√™te pour dispatch
\end{itemize}

\subsection{Diagramme de Classes - Entit√©s Validation/Assignment}

La figure \ref{fig:class-sprint3} pr√©sente le mod√®le de classes √©tendu avec les entit√©s d'audit.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{class-sprint3.png}
    \caption{Diagramme de classes - Sprint 3}
    \label{fig:class-sprint3}
\end{figure}

Les nouvelles entit√©s et attributs :

\begin{description}[leftmargin=*]
    \item[Request (√©tendu)] : 
    \begin{itemize}
        \item validatedAt, validatedBy (r√©f√©rences User)
        \item rejectionReason, rejectedAt, rejectedBy
        \item assignedDriverId, assignedGuardId, assignedAt
    \end{itemize}
    
    \item[SecurityOfficer] : Repr√©sente un agent de s√©curit√©
    \begin{itemize}
        \item cin, firstName, lastName, email, phone
        \item role (DRIVER | GUARD)
        \item availability (boolean)
    \end{itemize}
    
    \item[ActionLog] : Enregistre chaque action sur une demande
    \begin{itemize}
        \item requestId, action, actorId, details, timestamp
    \end{itemize}
\end{description}

Le mod√®le Prisma √©tendu :

\begin{lstlisting}[language=SQL]
model Request {
  // ... champs existants
  
  validatedAt     DateTime?
  validatedBy     User?     @relation("ValidatedBy", fields: [validatedById], references: [id])
  validatedById   Int?
  
  rejectionReason String?
  rejectedAt      DateTime?
  rejectedBy      User?     @relation("RejectedBy", fields: [rejectedById], references: [id])
  rejectedById    Int?
  
  assignedDriver   SecurityOfficer? @relation("Driver", fields: [assignedDriverId], references: [id])
  assignedDriverId Int?
  assignedGuard    SecurityOfficer? @relation("Guard", fields: [assignedGuardId], references: [id])
  assignedGuardId  Int?
  assignedAt       DateTime?
  
  actionLogs ActionLog[]
}

model SecurityOfficer {
  id           Int     @id @default(autoincrement())
  cin          String  @unique
  firstName    String
  lastName     String
  email        String  @unique
  phone        String
  role         String  // "DRIVER" | "GUARD"
  availability Boolean @default(true)
  
  driverAssignments Request[] @relation("Driver")
  guardAssignments  Request[] @relation("Guard")
  
  @@index([role, availability])
}

model ActionLog {
  id        Int      @id @default(autoincrement())
  request   Request  @relation(fields: [requestId], references: [id], onDelete: Cascade)
  requestId Int
  action    String   // "VALIDATED", "REJECTED", "ASSIGNED", etc.
  actor     User     @relation(fields: [actorId], references: [id])
  actorId   Int
  details   String?  // JSON string with additional info
  timestamp DateTime @default(now())
  
  @@index([requestId])
  @@index([timestamp])
}
\end{lstlisting}

\subsection{Diagramme de S√©quence - Validation}

La figure \ref{fig:sequence-validate} illustre le processus de validation d'une demande.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{sequence-validate.png}
    \caption{Diagramme de s√©quence - Validation de demande}
    \label{fig:sequence-validate}
\end{figure}

Le processus d√©taill√© :

\begin{enumerate}[leftmargin=*]
    \item L'utilisateur Caisse Centrale clique sur "Valider"
    \item Le frontend affiche un dialog de confirmation
    \item L'utilisateur confirme
    \item Requ√™te POST envoy√©e √† \texttt{/api/requests/[id]/validate}
    \item L'API v√©rifie l'authentification et le r√¥le (CaisseCentrale)
    \item L'API v√©rifie que le statut actuel = SUBMITTED
    \item L'API d√©marre une transaction Prisma
    \item L'API met √† jour la demande : status=VALIDATED, validatedBy, validatedAt
    \item L'API cr√©e un ActionLog
    \item L'API commit la transaction
    \item L'API d√©clenche une notification (queue ou email)
    \item L'API retourne la demande mise √† jour
    \item Le frontend affiche un toast de succ√®s
    \item Le frontend met √† jour la vue locale (optimistic update)
\end{enumerate}

\subsection{Diagramme de S√©quence - Assignment √âquipe}

La figure \ref{fig:sequence-assign} montre le processus d'assignment d'une √©quipe.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{sequence-assign.png}
    \caption{Diagramme de s√©quence - Assignment d'√©quipe}
    \label{fig:sequence-assign}
\end{figure}

Les √©tapes d√©taill√©es :

\begin{enumerate}[leftmargin=*]
    \item Tunisie S√©curit√© remplit le formulaire (driverId, guardId, notes)
    \item Le frontend valide : driverId ‚â† guardId
    \item Requ√™te POST √† \texttt{/api/requests/[id]/assign-team}
    \item L'API v√©rifie l'authentification et le r√¥le
    \item L'API v√©rifie statut = VALIDATED
    \item L'API v√©rifie l'existence et la disponibilit√© du chauffeur
    \item L'API v√©rifie l'existence et la disponibilit√© du garde
    \item L'API d√©marre une transaction
    \item L'API met √† jour la demande avec assignedDriverId, assignedGuardId, status=ASSIGNED
    \item L'API cr√©e un ActionLog avec d√©tails de l'√©quipe
    \item L'API commit la transaction
    \item L'API d√©clenche des notifications multiples
    \item L'API retourne la demande
    \item Le frontend affiche succ√®s
\end{enumerate}

\subsection{Diagramme d'Activit√©s - Validation Workflow}

La figure \ref{fig:activity-validation} pr√©sente le flux d√©cisionnel de validation.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\textwidth]{activity-validation.png}
    \caption{Diagramme d'activit√©s - Workflow de validation}
    \label{fig:activity-validation}
\end{figure}

Le flux inclut :

\begin{itemize}[leftmargin=*]
    \item Point de d√©cision : La demande est-elle acceptable ?
    \item Si OUI : Validation ‚Üí statut VALIDATED ‚Üí notifier Tunisie S√©curit√©
    \item Si NON : Demander motif ‚Üí Rejet ‚Üí statut REJECTED ‚Üí notifier Agence
    \item Chaque chemin enregistre un log d'action
\end{itemize}

\section{Conception D√©taill√©e}

\subsection{Architecture Composants Frontend}

Structure des composants :

\begin{verbatim}
components/
‚îú‚îÄ‚îÄ validate-dialog.tsx        # Dialog validation simple
‚îú‚îÄ‚îÄ reject-dialog.tsx          # Dialog rejet avec motif
‚îú‚îÄ‚îÄ assign-team-dialog.tsx     # Dialog assignment √©quipe
‚îú‚îÄ‚îÄ team-selector.tsx          # S√©lecteur chauffeur/garde
‚îî‚îÄ‚îÄ action-timeline.tsx        # Timeline des actions

app/requests/[id]/
‚îî‚îÄ‚îÄ page.tsx                   # Vue d√©tails avec actions conditionnelles
\end{verbatim}

\subsection{Routes API}

\begin{description}[leftmargin=*]
    \item[\texttt{POST /api/requests/[id]/validate}] : Validation de demande
    \begin{itemize}
        \item Authorization: R√¥le CaisseCentrale uniquement
        \item Body: \texttt{\{\}} (pas de donn√©es suppl√©mentaires)
        \item Retourne: Request avec status=VALIDATED
    \end{itemize}
    
    \item[\texttt{POST /api/requests/[id]/reject}] : Rejet de demande
    \begin{itemize}
        \item Authorization: R√¥le CaisseCentrale uniquement
        \item Body: \texttt{\{ rejectionReason: string \}}
        \item Validation: rejectionReason min 10 caract√®res
        \item Retourne: Request avec status=REJECTED
    \end{itemize}
    
    \item[\texttt{POST /api/requests/[id]/assign-team}] : Assignment √©quipe
    \begin{itemize}
        \item Authorization: R√¥le TunisieS√©curit√© uniquement
        \item Body: \texttt{\{ driverId: number, guardId: number, notes?: string \}}
        \item Validation: driverId ‚â† guardId, disponibilit√© des deux
        \item Retourne: Request avec status=ASSIGNED
    \end{itemize}
    
    \item[\texttt{GET /api/requests/[id]/history}] : Historique des actions
    \begin{itemize}
        \item Retourne: ActionLog[] ordonn√©s par timestamp DESC
    \end{itemize}
    
    \item[\texttt{GET /api/security-officers}] : Liste des agents
    \begin{itemize}
        \item Query params: role (DRIVER|GUARD), available (true|false)
        \item Retourne: SecurityOfficer[]
    \end{itemize}
\end{description}

\subsection{Middleware - V√©rification Permissions}

Protection des endpoints par r√¥le :

\begin{lstlisting}[language=JavaScript]
// lib/auth-middleware.ts
export function requireRole(allowedRoles: string[]) {
  return async (req: Request) => {
    const session = await getServerSession();
    
    if (!session) {
      return Response.json(
        { error: 'Non authentifie' },
        { status: 401 }
      );
    }
    
    if (!allowedRoles.includes(session.user.role)) {
      return Response.json(
        { error: 'Permission refusee' },
        { status: 403 }
      );
    }
    
    return null; // Permission OK
  };
}

// Usage dans API route
export async function POST(request: Request, { params }) {
  const authError = await requireRole(['CAISSE_CENTRALE'])(request);
  if (authError) return authError;
  
  // ... logique de validation
}
\end{lstlisting}

\section{R√©alisation - Impl√©mentation}

\subsection{Dialog Validation}

Composant simple de confirmation :

\begin{itemize}[leftmargin=*]
    \item Header : "Valider la demande \#REQ-2024-001"
    \item Body : R√©sum√© (montant, agence, type)
    \item Question : "Confirmez-vous la validation de cette demande ?"
    \item Actions : "Valider" (vert), "Annuler" (gris)
    \item Loader pendant l'appel API
    \item Toast de succ√®s apr√®s validation
\end{itemize}

\subsection{Dialog Rejet}

Composant avec formulaire :

\begin{itemize}[leftmargin=*]
    \item Header : "Rejeter la demande"
    \item Body : R√©sum√© de la demande
    \item Form :
    \begin{itemize}
        \item Label : "Motif du rejet *"
        \item Textarea (min 10 chars, max 500)
        \item Helper text : "Veuillez expliquer la raison du rejet"
        \item Validation en temps r√©el (compte de caract√®res)
    \end{itemize}
    \item Actions : "Rejeter" (rouge, disabled si motif invalide), "Annuler"
    \item Toast apr√®s succ√®s avec redirection
\end{itemize}

\subsection{Dialog Assignment √âquipe}

Composant complexe avec s√©lecteurs :

\begin{itemize}[leftmargin=*]
    \item Header : "Assigner une √©quipe"
    \item R√©sum√© demande (num√©ro, agence, montant)
    \item Form :
    \begin{itemize}
        \item Select "Chauffeur" :
        \begin{itemize}
            \item Options : CIN - Nom Pr√©nom
            \item Filtrage par disponibilit√© (disponibles en premier)
            \item Recherche textuelle
        \end{itemize}
        \item Select "Garde" :
        \begin{itemize}
            \item Options : CIN - Nom Pr√©nom
            \item Exclut le chauffeur s√©lectionn√©
            \item Filtrage disponibilit√©
        \end{itemize}
        \item Textarea "Notes" (optionnel)
    \end{itemize}
    \item Validation :
    \begin{itemize}
        \item Les deux s√©lections obligatoires
        \item Chauffeur ‚â† Garde
        \item Message d'erreur si m√™me personne
    \end{itemize}
    \item Actions : "Assigner" (disabled si invalide), "Annuler"
\end{itemize}

\subsection{Component Timeline Actions}

Affichage chronologique des √©v√©nements :

\begin{itemize}[leftmargin=*]
    \item Structure verticale avec ligne de connexion
    \item Pour chaque action :
    \begin{itemize}
        \item Ic√¥ne (‚úì validation, √ó rejet, üë§ assignment, üöö dispatch, ‚úÖ r√©ception)
        \item Date et heure format√©es
        \item Type d'action (badge color√©)
        \item Acteur : "Par Nom Pr√©nom (R√¥le)"
        \item D√©tails suppl√©mentaires :
        \begin{itemize}
            \item Si rejet : affichage du motif
            \item Si assignment : affichage des noms chauffeur/garde
            \item Si non-conformit√© : raison
        \end{itemize}
    \end{itemize}
    \item Animation au chargement (fade-in s√©quentiel)
\end{itemize}

\subsection{Affichage Conditionnel des Actions}

Dans la vue d√©tails, les actions disponibles d√©pendent du statut et du r√¥le :

\begin{lstlisting}[language=JavaScript]
// Logique d'affichage des boutons
const canValidate = 
  userRole === 'CAISSE_CENTRALE' && 
  request.status === 'SUBMITTED';

const canReject = 
  userRole === 'CAISSE_CENTRALE' && 
  request.status === 'SUBMITTED';

const canAssign = 
  userRole === 'TUNISIE_SECURITE' && 
  request.status === 'VALIDATED';

return (
  <div className="actions">
    {canValidate && <ValidateButton />}
    {canReject && <RejectButton />}
    {canAssign && <AssignTeamButton />}
  </div>
);
\end{lstlisting}

\section{Tests et Validation}

\subsection{Tests Fonctionnels}

\subsubsection{Validation}

\begin{itemize}[leftmargin=*]
    \item [\checkmark] Validation change statut SUBMITTED ‚Üí VALIDATED
    \item [\checkmark] Utilisateur et date enregistr√©s correctement
    \item [\checkmark] ActionLog cr√©√© avec d√©tails
    \item [\checkmark] Seul CaisseCentrale peut valider
    \item [\checkmark] Impossible de valider deux fois
\end{itemize}

\subsubsection{Rejet}

\begin{itemize}[leftmargin=*]
    \item [\checkmark] Rejet avec motif fonctionne
    \item [\checkmark] Motif obligatoire (erreur si vide)
    \item [\checkmark] Motif stock√© correctement
    \item [\checkmark] Notification envoy√©e √† agence
    \item [\checkmark] Statut passe √† REJECTED
\end{itemize}

\subsubsection{Assignment}

\begin{itemize}[leftmargin=*]
    \item [\checkmark] Assignment avec chauffeur et garde diff√©rents r√©ussit
    \item [\checkmark] Erreur si m√™me personne pour les deux r√¥les
    \item [\checkmark] Erreur si agent indisponible
    \item [\checkmark] Statut passe √† ASSIGNED
    \item [\checkmark] Seul TunisieS√©curit√© peut assigner
\end{itemize}

\subsubsection{Tra√ßabilit√©}

\begin{itemize}[leftmargin=*]
    \item [\checkmark] Chaque action cr√©e un log
    \item [\checkmark] Timeline affiche tous les logs ordonn√©s
    \item [\checkmark] D√©tails sp√©cifiques pr√©sents (motif, √©quipe)
    \item [\checkmark] Timestamp pr√©cis enregistr√©
\end{itemize}

\subsection{Tests de S√©curit√©}

\begin{itemize}[leftmargin=*]
    \item [\checkmark] Agence ne peut pas valider
    \item [\checkmark] Agence ne peut pas assigner √©quipe
    \item [\checkmark] CaisseCentrale ne peut pas assigner
    \item [\checkmark] TunisieS√©curit√© ne peut pas valider/rejeter
    \item [\checkmark] Requ√™tes non authentifi√©es refus√©es (401)
    \item [\checkmark] Requ√™tes sans permission refus√©es (403)
\end{itemize}

\section{Revue de Sprint}

\subsection{D√©monstration}

D√©monstration compl√®te du workflow :

\begin{enumerate}[leftmargin=*]
    \item Connexion en tant que Caisse Centrale
    \item Consultation liste demandes SUBMITTED
    \item Examen d√©tails d'une demande
    \item Validation de la demande
    \item V√©rification du changement de statut et log
    \item D√©connexion et reconnexion en Tunisie S√©curit√©
    \item Consultation demandes VALIDATED
    \item Assignment d'une √©quipe (s√©lection chauffeur + garde)
    \item V√©rification statut ASSIGNED et timeline compl√®te
    \item Test de rejet : cr√©ation demande, tentative rejet sans motif (erreur), rejet avec motif (succ√®s)
\end{enumerate}

\subsection{Validation Product Owner}

Points valid√©s :

\begin{itemize}[leftmargin=*]
    \item Workflow clair et intuitif
    \item S√©curit√© des permissions robuste
    \item Tra√ßabilit√© compl√®te (audit trail)
    \item Ergonomie des dialogs (simples et efficaces)
    \item Performance (actions instantan√©es)
\end{itemize}

\subsection{Feedback}

Suggestions :

\begin{itemize}[leftmargin=*]
    \item Ajouter filtres sur disponibilit√© agents dans liste [\checkmark\ Impl√©ment√©]
    \item Permettre modification de l'√©quipe si encore en ASSIGNED [\textit{Backlog}]
    \item Afficher statistiques de validation (taux, d√©lai moyen) [\textit{Sprint 4}]
\end{itemize}

\subsection{M√©triques du Sprint}

\begin{itemize}[leftmargin=*]
    \item \textbf{Dur√©e} : 3 semaines
    \item \textbf{User Stories compl√©t√©es} : 6/6 (100\%)
    \item \textbf{Points de complexit√©} : 34/34
    \item \textbf{Bugs identifi√©s} : 4 (tous r√©solus)
    \item \textbf{Couverture permissions} : 100\% (tous r√¥les test√©s)
\end{itemize}

\section{Conclusion du Chapitre}

Le Sprint 3 a permis d'impl√©menter le workflow critique de validation et d'assignment. Les m√©canismes d'approbation multiniveaux garantissent que seules les demandes l√©gitimes sont trait√©es, tandis que le syst√®me d'assignment optimise l'allocation des ressources logistiques.

La tra√ßabilit√© compl√®te via les ActionLogs constitue un atout majeur pour l'audit et la conformit√© r√©glementaire. Chaque d√©cision est document√©e avec son contexte, son acteur et son horodatage, permettant une reconstitution fid√®le de l'historique.

Le syst√®me est maintenant pr√™t pour les √©tapes finales : le dispatch des fonds par Tunisie S√©curit√© et leur r√©ception par les agences, qui seront d√©velopp√©s dans le Sprint 4 avec le module analytics.

\newpage
